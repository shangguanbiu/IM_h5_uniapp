import{_ as t,a as e,s,n as a,g as i,K as l,o,e as n,w as d,i as _,f as r,j as c,k as u,r as h,F as f,l as p,v as m,t as k,m as y,x,z as g,P as w,Q as b}from"./index-94068fa3.js";import{_ as v}from"./common.b05f9007.js";import{_ as U,a as I}from"./nan.89d00671.js";import{_ as $,a as C}from"./nan_b.1f2ad1df.js";const T=e(s);const O=t({data:()=>({pop_notice:!1,notice_type:1,notice_content:"您当前可打招呼次数已达到每日限制，联更多的TA可开通会员，请联系客服",paddingB:0,total:0,params:{page:1,limit:10,is_mine:0},list:[],iflike:!1,had_likes:[],show_talk:!1,talk_data:{},fromUserid:"",fromUser:"",send_content:"",host:""}),methods:{bet_talk(t){this.show_talk=!0,this.talk_data=t},pop_ok(){a({url:"/pages/movie/kefu/kefu"})},getList(){this.$api.third_openApi.like_me_index(this.params).then((t=>{if(0==t.code){let e=t.data.data;this.total=t.count,e.forEach((t=>{this.$set(t,"iflike",!1),this.$set(t,"isfar",(1.5*Math.random()+1).toFixed(2)),this.$set(t,"ifonline",Math.random()>=.5),this.$set(t,"istime",(.5*Math.random()+1).toFixed(2)),this.had_likes.forEach((e=>{t.account==e&&(t.iflike=!0)}))})),this.fromUser.islevel<22?this.list=e.slice(0,5):this.list=e}}))},setLike(t,e,s){var a={type:t,user_id:i("userInfo").user_id,user_account:e};1==t&&this.$api.third_openApi.near_user_like(a).then((t=>{0==t.code&&(this.list[s].iflike=!0)}))},async check_if_friend(t){if(0==this.fromUser.istalk&&0==this.fromUser.role)return this.pop_notice=!0,void(this.notice_type=1);var e=new Array;e.push(this.fromUser.user_id),e.push(t);200==(await this.$myRuquest({url:"/api/front/index/saveImUser",method:"POST",data:{users:e.toString()}})).code&&this.sendMessage(t)},sendMessage(t){let e={id:this.$util.getUuid(),is_group:0,fromUser:this.fromUser,type:"text",toContactId:t,content:this.send_content,sendTime:(new Date).getTime()};this.$api.msgApi.sendMessage(e).then((t=>{0==t.code?(this.show_talk=!1,this.notice_content="已打招呼，等待TA的回应！可在下方栏目-消息中查看",this.pop_notice=!0,this.notice_type=2,this.count_number()):l({title:t.msg,icon:"none"})})).catch((t=>{}))},async count_number(){let t=JSON.parse(JSON.stringify(T.userInfo));200==(await this.$myRuquest({url:"/api/front/index/changeImUserData",method:"POST",data:{user_id:t.user_id,column:"istalk"}})).code&&this.get_userinfo()},async get_userinfo(){let t=JSON.parse(JSON.stringify(T.userInfo));const e=await this.$myRuquest({url:"/api/front/index/getImUserInfo",method:"POST",data:{user_id:t.user_id}});if(200==e.code){this.fromUser=e.data;let t=JSON.parse(JSON.stringify(e.data));T.login(t)}}},created(){this.paddingB=this.inlineTools,this.getList();var t=i("userInfo");this.had_likes=t.islikes.split(","),this.fromUser=i("userInfo"),this.host=this.$imgurl()}},[["render",function(t,e,s,a,i,l){const T=x("cu-custom"),O=g,S=_,F=x("Empty"),A=w,j=b;return o(),n(S,null,{default:d((()=>[r(T,{bgColor:"bg-gradual-pink",isBack:!0},{backText:d((()=>[])),content:d((()=>[c("喜欢我的TA")])),_:1}),0!==i.list.length?(o(),n(S,{key:0},{default:d((()=>[(o(!0),u(f,null,h(i.list,((t,e)=>p((o(),n(S,{class:"user_line",key:e},{default:d((()=>[r(S,{class:"user_l"},{default:d((()=>[null!==t.avatar?(o(),n(O,{key:0,src:i.host+t.avatar,style:{width:"80px",height:"80px","border-radius":"50%"}},null,8,["src"])):(o(),n(O,{key:1,src:v,style:{width:"80px",height:"80px","border-radius":"50%"}})),r(S,{class:"item_like"},{default:d((()=>[t.ifonline?(o(),n(S,{key:0,class:"cuIcon-title",onClick:s=>l.setLike(2,t.account,e)},null,8,["onClick"])):y("",!0)])),_:2},1024)])),_:2},1024),r(S,{class:"user_r"},{default:d((()=>[r(S,{class:"item_name"},{default:d((()=>[r(S,{style:{display:"flex"}},{default:d((()=>[0==t.sex?(o(),n(S,{key:0,class:"sex_ico"},{default:d((()=>[r(O,{src:U,style:{width:"100%"},mode:"widthFix"})])),_:1})):y("",!0),1==t.sex?(o(),n(S,{key:1,class:"sex_ico"},{default:d((()=>[r(O,{src:I,style:{width:"100%"},mode:"widthFix"})])),_:1})):y("",!0),c(" "+k(t.realname),1)])),_:2},1024),r(S,{class:"col_96",style:{display:"flex",width:"150px","justify-content":"flex-end"}},{default:d((()=>[r(S,null,{default:d((()=>[c(k(t.isfar)+"km · ",1)])),_:2},1024),t.ifonline?(o(),n(S,{key:0},{default:d((()=>[c("在线")])),_:1})):y("",!0),t.ifonline?y("",!0):(o(),n(S,{key:1},{default:d((()=>[c(k(t.istime)+"小时",1)])),_:2},1024))])),_:2},1024)])),_:2},1024),r(S,{style:{margin:"5px 0","text-align":"right"}},{default:d((()=>[r(S,{class:"item_btn",onClick:e=>l.bet_talk(t)},{default:d((()=>[c("打招呼")])),_:2},1032,["onClick"])])),_:2},1024),""!==t.motto&&null!==t.motto?(o(),n(S,{key:0,class:"motto"},{default:d((()=>[c("签名："+k(t.motto),1)])),_:2},1024)):y("",!0)])),_:2},1024)])),_:2},1024)),[[m,e<4]]))),128))])),_:1})):(o(),n(F,{key:1,noDatatext:"暂无记录",textcolor:"#999"})),p(r(S,null,{default:d((()=>[r(S,{class:"com_bg",onClick:e[0]||(e[0]=t=>i.show_talk=!1)}),r(S,{class:"talk_mian"},{default:d((()=>[r(S,{style:{width:"90%",margin:"auto"}},{default:d((()=>[r(S,{class:"talk_ico"},{default:d((()=>[null!==i.talk_data.avatar?(o(),n(O,{key:0,src:i.talk_data.avatar,style:{width:"100%","border-radius":"50%",height:"80px"},mode:"widthFix"},null,8,["src"])):(o(),n(O,{key:1,src:v,style:{width:"100%","border-radius":"50%",height:"80px"},mode:"widthFix"}))])),_:1}),r(S,{class:"talk_name"},{default:d((()=>[c(k(i.talk_data.realname),1)])),_:1}),r(S,{class:"talk_desc"},{default:d((()=>[0==i.talk_data.sex?(o(),n(S,{key:0,class:"talk_sex p_type1"},{default:d((()=>[r(S,{class:"sex_ico"},{default:d((()=>[r(O,{src:$,style:{width:"100%"},mode:"widthFix"})])),_:1}),r(S,{style:{"line-height":"25px"}},{default:d((()=>[c(k(i.talk_data.ages),1)])),_:1})])),_:1})):y("",!0),1==i.talk_data.sex?(o(),n(S,{key:1,class:"talk_sex p_type1"},{default:d((()=>[r(S,{class:"sex_ico"},{default:d((()=>[r(O,{src:C,style:{width:"100%"},mode:"widthFix"})])),_:1}),r(S,{style:{"line-height":"25px"}},{default:d((()=>[c(k(i.talk_data.ages),1)])),_:1})])),_:1})):y("",!0),2==i.talk_data.sex?(o(),n(S,{key:2,class:"talk_sex p_type3"},{default:d((()=>[r(S,{style:{"line-height":"25px"}},{default:d((()=>[c(k(i.talk_data.ages),1)])),_:1})])),_:1})):y("",!0),r(S,{class:"talk_sex p_type3"},{default:d((()=>[r(S,{style:{"line-height":"25px"}},{default:d((()=>[c("vip-"+k(i.talk_data.islevel),1)])),_:1})])),_:1})])),_:1}),r(S,{class:"talk_form"},{default:d((()=>[r(S,{style:{"padding-left":"10px"}},{default:d((()=>[r(A,{placeholder:"随意打个招呼吧",style:{height:"32px","font-size":"14px"},maxlength:"32",name:"input",modelValue:i.send_content,"onUpdate:modelValue":e[1]||(e[1]=t=>i.send_content=t)},null,8,["modelValue"])])),_:1}),r(S,null,{default:d((()=>[r(j,{class:"cu-btn bg-blue shadow",onClick:e[2]||(e[2]=t=>l.check_if_friend(i.talk_data.user_id))},{default:d((()=>[c("发送")])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})])),_:1},512),[[m,i.show_talk]]),p(r(S,null,{default:d((()=>[r(S,{class:"com_bg"}),r(S,{class:"com_main"},{default:d((()=>[r(S,{class:"pop_mian"},{default:d((()=>[r(S,{class:"pop_title"},{default:d((()=>[c("提示")])),_:1}),r(S,{style:{padding:"10px 15px","line-height":"25px","flex-wrap":"wrap","text-align":"center"}},{default:d((()=>[c(k(i.notice_content),1)])),_:1}),r(S,{class:"pop_foot"},{default:d((()=>[1==i.notice_type?(o(),n(S,{key:0,class:"pop_ft_btn1",onClick:e[3]||(e[3]=t=>i.pop_notice=!1)},{default:d((()=>[c("关闭")])),_:1})):y("",!0),1==i.notice_type?(o(),n(S,{key:1,class:"pop_ft_btn2",onClick:e[4]||(e[4]=t=>l.pop_ok())},{default:d((()=>[c("去升级")])),_:1})):y("",!0),2==i.notice_type?(o(),n(S,{key:2,class:"pop_ft_btn2",onClick:e[5]||(e[5]=t=>i.pop_notice=!1)},{default:d((()=>[c("确定")])),_:1})):y("",!0)])),_:1})])),_:1})])),_:1})])),_:1},512),[[m,i.pop_notice]])])),_:1})}],["__scopeId","data-v-3aac93b7"]]);export{O as default};
