import{_ as e,a,s as t,K as o,V as s,o as l,e as n,w as r,i,f as c,j as u,t as d,x as m,z as g,P as p,ab as f,Q as h}from"./index-784797a9.js";import{p as _}from"./package.fba20730.js";const F=a(t);const w=e({data:()=>({regForm:{account:"",realname:"",password:"",repass:"",code:""},forget:!1,packData:_,globalConfig:F.globalConfig,base_url:"",time:parseInt((new Date).getTime()/1e3)}),watch:{forget(e){e&&(this.regForm.password="123456")}},mounted(){this.base_url=this.$baseurl()},methods:{run_time(){this.time=parseInt((new Date).getTime()/1e3)},handleInput(e){let a=e.detail.value.replace(/[\u4e00-\u9fa5]/g,"");this.regForm.account=a},sendCode(){if(!this.regForm.account)return o({title:"请输入账号！",icon:"none"}),!1;let e={account:this.regForm.account,type:2};this.$api.LoginApi.sendCode(e).then((e=>{o({title:e.msg,icon:"none"})}))},async check_yan_zm(){if(""==this.regForm.code)return o({title:"请输入验证码！",icon:"none"}),!1;(await this.$myRuquest({method:"Post",url:"/api/front/user/checkCode",data:{code:this.regForm.code}})).code},login(){return""==this.regForm.account?(o({title:"请输入账号！",icon:"none"}),!1):""==this.regForm.realname?(o({title:"请输入用户名或者昵称！",icon:"none"}),!1):""==this.regForm.password&&this.regForm.password.length<6&&this.regForm.password>16?(o({title:"请输入6-16位密码！",icon:"none"}),!1):this.regForm.password!=this.regForm.repass?(o({title:"两次密码输入不相同！",icon:"none"}),!1):void this.$api.LoginApi.register(this.regForm).then((e=>{0==e.code&&this.check_if_friend(e.data.user_id)}))},async check_if_friend(e){var a=new Array;a.push(1),a.push(e);200==(await this.$myRuquest({url:"/api/front/index/saveImUser",method:"POST",data:{users:a.toString()}})).code&&this.sendMessage(e)},async sendMessage(e){let a={id:this.$util.getUuid(),from_user:1,to_user:e,content:"欢迎加入喇叭花，我是人工接待员将为您24小时咨询服务",create_time:(new Date).getTime()/1e3};200==(await this.$myRuquest({url:"/api/front/index/changeImMessageData",method:"POST",data:a})).code&&setTimeout((()=>{s({url:"/pages/login/index"})}),2e3)}}},[["render",function(e,a,t,o,s,_){const F=m("cu-custom"),w=i,x=g,y=p,k=f,b=h;return l(),n(w,null,{default:r((()=>[c(F,{bgColor:"bg-gradual-pink",isBack:!0},{backText:r((()=>[])),content:r((()=>[u("账号注册")])),_:1}),c(w,{style:{height:"100rpx"}}),c(w,{class:"padding im-flex im-rows im-justify-content-center mb-10"},{default:r((()=>[c(w,{class:"im-flex im-rows im-justify-content-center"},{default:r((()=>[c(x,{class:"login-logo",src:s.globalConfig.sysInfo.logo??s.packData.logo,mode:"fixWidth"},null,8,["src"])])),_:1})])),_:1}),c(w,{class:"im-flex im-rows im-justify-content-center"},{default:r((()=>[u(d(s.globalConfig.sysInfo.name??s.packData.name),1)])),_:1}),c(k,null,{default:r((()=>[c(w,{class:"cu-form-group margin-top"},{default:r((()=>[c(w,{class:"title"},{default:r((()=>[u("账号")])),_:1}),c(y,{placeholder:"账号",class:"uni-input",maxlength:"32",name:"input",modelValue:s.regForm.account,"onUpdate:modelValue":a[0]||(a[0]=e=>s.regForm.account=e),onInput:_.handleInput},null,8,["modelValue","onInput"])])),_:1}),c(w,{class:"cu-form-group margin-top"},{default:r((()=>[c(w,{class:"title"},{default:r((()=>[u("用户名/昵称")])),_:1}),c(y,{placeholder:"请输入用户名或昵称",maxlength:"32",name:"input",modelValue:s.regForm.realname,"onUpdate:modelValue":a[1]||(a[1]=e=>s.regForm.realname=e)},null,8,["modelValue"])])),_:1}),c(w,{class:"cu-form-group"},{default:r((()=>[c(w,{class:"title"},{default:r((()=>[u("密码")])),_:1}),c(y,{placeholder:"请输入密码",maxlength:"32",type:"password",name:"input",modelValue:s.regForm.password,"onUpdate:modelValue":a[2]||(a[2]=e=>s.regForm.password=e)},null,8,["modelValue"])])),_:1}),c(w,{class:"cu-form-group"},{default:r((()=>[c(w,{class:"title"},{default:r((()=>[u("重复密码")])),_:1}),c(y,{placeholder:"请重复输入密码",maxlength:"32",type:"password",name:"input",modelValue:s.regForm.repass,"onUpdate:modelValue":a[3]||(a[3]=e=>s.regForm.repass=e)},null,8,["modelValue"])])),_:1}),c(w,{class:"cu-form-group"},{default:r((()=>[c(w,{class:"title"},{default:r((()=>[u("验证码")])),_:1}),c(y,{placeholder:"请输入验证码",maxlength:"6",name:"input",modelValue:s.regForm.code,"onUpdate:modelValue":a[4]||(a[4]=e=>s.regForm.code=e)},null,8,["modelValue"]),c(x,{src:s.base_url+"/api/front/captcha/index?t="+s.time,onClick:_.run_time,mode:"widthFix",style:{width:"114px"}},null,8,["src","onClick"])])),_:1})])),_:1}),c(w,{class:"flex flex-direction im-login-btn"},{default:r((()=>[c(b,{class:"cu-btn lg bg-pink",onClick:a[5]||(a[5]=e=>_.check_yan_zm())},{default:r((()=>[u("注册")])),_:1})])),_:1}),c(w,{class:"footer-version c-999"},{default:r((()=>[u(d(s.globalConfig.sysInfo.name??s.packData.name)+" for "+d(s.packData.version),1)])),_:1})])),_:1})}],["__scopeId","data-v-1807a9cd"]]);export{w as default};
