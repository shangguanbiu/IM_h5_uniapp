import{_ as e,a,s as o,J as t,U as s,o as l,e as n,w as r,i,f as u,j as d,t as c,m,q as g,y as p,O as f,P as h,aa as _}from"./index-45871c8e.js";import{p as F}from"./package.548099a0.js";const w=a(o);const x=e({data:()=>({regForm:{account:"",realname:"",password:"",repass:"",code:""},forget:!1,packData:F,globalConfig:w.globalConfig}),watch:{forget(e){e&&(this.regForm.password="123456")}},mounted(){},methods:{handleInput(e){let a=e.detail.value.replace(/[\u4e00-\u9fa5]/g,"");this.regForm.account=a},sendCode(){if(!this.regForm.account)return t({title:"请输入账号！",icon:"none"}),!1;let e={account:this.regForm.account,type:2};this.$api.LoginApi.sendCode(e).then((e=>{t({title:e.msg,icon:"none"})}))},login(){return""==this.regForm.account?(t({title:"请输入账号！",icon:"none"}),!1):""==this.regForm.realname?(t({title:"请输入用户名或者昵称！",icon:"none"}),!1):""==this.regForm.password&&this.regForm.password.length<6&&this.regForm.password>16?(t({title:"请输入6-16位密码！",icon:"none"}),!1):this.regForm.password!=this.regForm.repass?(t({title:"两次密码输入不相同！",icon:"none"}),!1):void this.$api.LoginApi.register(this.regForm).then((e=>{0==e.code&&this.check_if_friend(e.data.user_id)}))},async check_if_friend(e){var a=new Array;a.push(1),a.push(e);200==(await this.$myRuquest({url:"/api/front/index/saveImUser",method:"POST",data:{users:a.toString()}})).code&&this.sendMessage(e)},async sendMessage(e){let a={id:this.$util.getUuid(),from_user:1,to_user:e,content:"欢迎加入喇叭花，我是人工接待员将为您24小时咨询服务",create_time:(new Date).getTime()/1e3};200==(await this.$myRuquest({url:"/api/front/index/changeImMessageData",method:"POST",data:a})).code&&setTimeout((()=>{s({url:"/pages/login/index"})}),2e3)}}},[["render",function(e,a,o,t,s,F){const w=g("cu-custom"),x=i,y=p,b=f,k=h,V=_;return l(),n(x,null,{default:r((()=>[u(w,{bgColor:"bg-gradual-pink",isBack:!0},{backText:r((()=>[])),content:r((()=>[d("账号注册")])),_:1}),u(x,{style:{height:"100rpx"}}),u(x,{class:"padding im-flex im-rows im-justify-content-center mb-10"},{default:r((()=>[u(x,{class:"im-flex im-rows im-justify-content-center"},{default:r((()=>[u(y,{class:"login-logo",src:s.globalConfig.sysInfo.logo??s.packData.logo,mode:"fixWidth"},null,8,["src"])])),_:1})])),_:1}),u(x,{class:"im-flex im-rows im-justify-content-center"},{default:r((()=>[d(c(s.globalConfig.sysInfo.name??s.packData.name),1)])),_:1}),u(V,null,{default:r((()=>[u(x,{class:"cu-form-group margin-top"},{default:r((()=>[u(x,{class:"title"},{default:r((()=>[d("账号")])),_:1}),u(b,{placeholder:"账号",class:"uni-input",maxlength:"32",name:"input",modelValue:s.regForm.account,"onUpdate:modelValue":a[0]||(a[0]=e=>s.regForm.account=e),onInput:F.handleInput},null,8,["modelValue","onInput"])])),_:1}),u(x,{class:"cu-form-group margin-top"},{default:r((()=>[u(x,{class:"title"},{default:r((()=>[d("用户名/昵称")])),_:1}),u(b,{placeholder:"请输入用户名或昵称",maxlength:"32",name:"input",modelValue:s.regForm.realname,"onUpdate:modelValue":a[1]||(a[1]=e=>s.regForm.realname=e)},null,8,["modelValue"])])),_:1}),parseInt(s.globalConfig.sysInfo.regauth)?(l(),n(x,{key:0,class:"cu-form-group"},{default:r((()=>[u(x,{class:"title"},{default:r((()=>[d("验证码")])),_:1}),u(b,{placeholder:"请输入验证码",maxlength:"6",name:"input",modelValue:s.regForm.code,"onUpdate:modelValue":a[2]||(a[2]=e=>s.regForm.code=e)},null,8,["modelValue"]),u(k,{class:"cu-btn bg-blue shadow",onClick:F.sendCode},{default:r((()=>[d("发送验证码")])),_:1},8,["onClick"])])),_:1})):m("",!0),u(x,{class:"cu-form-group"},{default:r((()=>[u(x,{class:"title"},{default:r((()=>[d("密码")])),_:1}),u(b,{placeholder:"请输入密码",maxlength:"32",type:"password",name:"input",modelValue:s.regForm.password,"onUpdate:modelValue":a[3]||(a[3]=e=>s.regForm.password=e)},null,8,["modelValue"])])),_:1}),u(x,{class:"cu-form-group"},{default:r((()=>[u(x,{class:"title"},{default:r((()=>[d("重复密码")])),_:1}),u(b,{placeholder:"请重复输入密码",maxlength:"32",type:"password",name:"input",modelValue:s.regForm.repass,"onUpdate:modelValue":a[4]||(a[4]=e=>s.regForm.repass=e)},null,8,["modelValue"])])),_:1})])),_:1}),u(x,{class:"flex flex-direction im-login-btn"},{default:r((()=>[u(k,{class:"cu-btn lg bg-pink",onClick:a[5]||(a[5]=e=>F.login())},{default:r((()=>[d("注册")])),_:1})])),_:1}),u(x,{class:"footer-version c-999"},{default:r((()=>[d(c(s.globalConfig.sysInfo.name??s.packData.name)+" for "+c(s.packData.version),1)])),_:1})])),_:1})}],["__scopeId","data-v-e4de63f7"]]);export{x as default};
