import{_ as t,u as e,s as a,a as s,n as l,a9 as n,K as c,D as i,V as d,o,e as u,w as r,i as f,f as m,j as _,t as g,C as h,m as k,k as x,F as b,q as $,x as y,y as p,Q as C}from"./index-d8cdb88b.js";const I=e(a),v=s(a);const N=t({data:()=>({modelName:"",detail:{},userInfo:v.userInfo,globalConfig:v.globalConfig}),computed:{validatePhone(){return/^1[3456789]\d{9}$/.test(this.detail.account)}},onLoad(t){this.$api.msgApi.getUserInfo({user_id:t.id}).then((t=>{0==t.code&&(this.detail=t.data)}))},methods:{sendMsg(t){l({url:"/pages/message/chat?id="+t.user_id})},sex(t){return[this.$t("contact.sex_nv"),this.$t("contact.sex_nan"),this.$t("contact.no_msg")][t]||this.$t("contact.no_msg")},callPhone(){n({phoneNumber:this.detail.account})},calling(t){if(I.webrtcLock)return c({title:this.$t("contact.other"),icon:"none"});this.modelName="";let e=this.$util.getUuid();l({url:"/pages/message/call?msg_id="+e+"&type="+t+"&status=1&id="+this.detail.user_id+"&name="+this.detail.realname+"&avatar="+encodeURI(this.detail.avatar)})},delFriend(){i({title:this.$t("contact.sure_del"),success:t=>{if(t.confirm){let t={id:this.detail.user_id};this.$api.friendApi.delFriend(t).then((e=>{0==e.code&&(I.deleteContacts(t),d({url:"/pages/index/index"}))}))}}})},addFriend(){i({title:this.$t("contact.check_msg"),editable:!0,success:t=>{if(t.confirm){if(""==t.content)return c({title:this.$t("contact.check_remark"),icon:"error"});this.$api.friendApi.addFriend({user_id:this.detail.user_id,remark:t.content}).then((t=>{0==t.code&&c({title:t.msg,icon:"none"})}))}}})},setNickname(){let t=this.detail.friend.friend_id??"";if(!this.detail.friend)return c({title:this.$t("contact.can_not_set"),icon:"error"});i({title:this.$t("contact.check_remark2"),editable:!0,success:e=>{if(e.confirm){if(""==e.content)return c({title:this.$t("contact.check_remark3"),icon:"error"});this.$api.friendApi.setNickname({friend_id:t,nickname:e.content}).then((t=>{0==t.code&&(this.detail.friend.nickname=e.content,c({title:t.msg,icon:"none"}))}))}}})}}},[["render",function(t,e,a,s,l,n){const c=y("cu-custom"),i=f,d=p,I=C;return o(),u(i,null,{default:r((()=>[m(c,{bgColor:"bg-white",isBack:!0},{backText:r((()=>[])),content:r((()=>[_(g(t.$t("contact.title")),1)])),_:1}),m(i,{class:"padding flex justify-start align-center"},{default:r((()=>[m(i,{class:"cu-avatar lg radius mr-15",style:h("background-image:url("+l.detail.avatar+")")},null,8,["style"]),m(i,{class:"im-flex im-justify-content-start im-columns"},{default:r((()=>[m(i,{class:"mb-5"},{default:r((()=>[_(g(l.detail.realname),1)])),_:1}),m(i,{class:"text-gray"},{default:r((()=>[_(g(l.detail.account),1)])),_:1})])),_:1})])),_:1}),m(i,{class:"cu-list menu"},{default:r((()=>[2==l.globalConfig.sysInfo.runMode&&l.detail.friend&&l.userInfo.user_id!=l.detail.user_id?(o(),u(i,{key:0,class:"cu-item",onClick:n.setNickname},{default:r((()=>[m(i,{class:"content"},{default:r((()=>[m(d,{class:"cuIcon-edit text-green"}),m(d,null,{default:r((()=>[_(g(t.$t("contact.remarks")),1)])),_:1})])),_:1}),m(i,{class:"action"},{default:r((()=>[m(d,{class:"text-grey text-sm"},{default:r((()=>[_(g(l.detail.friend.nickname||t.$t("contact.no_set")),1)])),_:1}),m(d,{class:"text-grey text-sm ml-5 cuIcon-write"})])),_:1})])),_:1},8,["onClick"])):k("",!0),m(i,{class:"cu-item"},{default:r((()=>[m(i,{class:"content"},{default:r((()=>[m(d,{class:"cuIcon-mail text-green"}),m(d,null,{default:r((()=>[_(g(t.$t("contact.emial")),1)])),_:1})])),_:1}),m(i,{class:"action"},{default:r((()=>[m(d,{class:"text-grey text-sm"},{default:r((()=>[_(g(l.detail.email??""),1)])),_:1})])),_:1})])),_:1}),m(i,{class:"cu-item"},{default:r((()=>[m(i,{class:"content"},{default:r((()=>[m(d,{class:"cuIcon-safe text-green"}),m(d,null,{default:r((()=>[_(g(t.$t("contact.sex")),1)])),_:1})])),_:1}),m(i,{class:"action"},{default:r((()=>[m(d,{class:"text-grey text-sm"},{default:r((()=>[_(g(n.sex(l.detail.sex)),1)])),_:1})])),_:1})])),_:1}),parseInt(l.globalConfig.sysInfo.ipregion)?(o(),u(i,{key:1,class:"cu-item"},{default:r((()=>[m(i,{class:"content"},{default:r((()=>[m(d,{class:"cuIcon-location text-green"}),m(d,null,{default:r((()=>[_("IP")])),_:1})])),_:1}),m(i,{class:"action"},{default:r((()=>[l.detail.last_login_ip?(o(),u(d,{key:0,class:"text-grey text-sm"},{default:r((()=>[_(g(l.detail.last_login_ip||t.$t("contact.no_msg"))+" （"+g(l.detail.location||t.$t("contact.no_msg"))+"）",1)])),_:1})):(o(),u(d,{key:1,class:"text-grey text-sm"},{default:r((()=>[_("未知")])),_:1}))])),_:1})])),_:1})):k("",!0)])),_:1}),l.userInfo.user_id!=l.detail.user_id?(o(),x(b,{key:0},[1==l.globalConfig.sysInfo.runMode||l.detail.friend?(o(),u(i,{key:0,class:"padding flex flex-direction"},{default:r((()=>[m(I,{class:"cu-btn bg-green mt-10 lg",onClick:e[0]||(e[0]=t=>n.sendMsg(l.detail))},{default:r((()=>[_(g(t.$t("contact.send_msg")),1)])),_:1}),n.validatePhone?(o(),u(I,{key:0,class:"cu-btn bg-blue mt-10 lg",onClick:e[1]||(e[1]=t=>n.callPhone())},{default:r((()=>[_(g(t.$t("contact.call")),1)])),_:1})):k("",!0),parseInt(l.globalConfig.chatInfo.webrtc)?(o(),u(I,{key:1,class:"cu-btn bg-grey mt-10 lg",onClick:e[2]||(e[2]=t=>l.modelName="callRtc")},{default:r((()=>[_(g(t.$t("contact.video")),1)])),_:1})):k("",!0),2==l.globalConfig.sysInfo.runMode?(o(),u(I,{key:2,class:"cu-btn bg-red mt-10 lg",onClick:e[3]||(e[3]=t=>n.delFriend())},{default:r((()=>[_(g(t.$t("contact.del_friend")),1)])),_:1})):k("",!0)])),_:1})):k("",!0),2!=l.globalConfig.sysInfo.runMode||l.detail.friend?k("",!0):(o(),u(i,{key:1,class:"padding flex flex-direction"},{default:r((()=>[m(I,{class:"cu-btn bg-green lg",onClick:e[4]||(e[4]=t=>n.addFriend())},{default:r((()=>[_(g(t.$t("contact.add_friend")),1)])),_:1})])),_:1}))],64)):k("",!0),m(i,{class:$(["cu-modal bottom-modal","callRtc"==l.modelName?"show":""]),onClick:e[8]||(e[8]=t=>l.modelName="")},{default:r((()=>[m(i,{class:"cu-dialog"},{default:r((()=>[m(i,{class:"manage-content"},{default:r((()=>[m(i,{class:"cu-list menu bg-white"},{default:r((()=>[m(i,{class:"cu-item",onClick:e[5]||(e[5]=t=>n.calling(0))},{default:r((()=>[m(i,{class:"content padding-tb-sm"},{default:r((()=>[m(d,{class:"cuIcon-dianhua"}),m(d,null,{default:r((()=>[_(g(t.$t("contact.video_yuyin")),1)])),_:1})])),_:1})])),_:1}),m(i,{class:"cu-item",onClick:e[6]||(e[6]=t=>n.calling(1))},{default:r((()=>[m(i,{class:"content padding-tb-sm"},{default:r((()=>[m(d,{class:"cuIcon-record"}),m(d,null,{default:r((()=>[_(g(t.$t("contact.video_shiping")),1)])),_:1})])),_:1})])),_:1}),m(i,{class:"parting-line-5"}),m(i,{class:"cu-item",onClick:e[7]||(e[7]=t=>l.modelName="")},{default:r((()=>[m(i,{class:"content padding-tb-sm"},{default:r((()=>[m(d,{class:"c-red"},{default:r((()=>[_(g(t.$t("contact.close")),1)])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})])),_:1},8,["class"])])),_:1})}]]);export{N as default};
