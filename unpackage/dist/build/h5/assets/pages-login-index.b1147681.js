import{_ as o,a as e,s as t,g as l,n as a,K as n,c as i,aa as s,V as c,o as r,e as g,w as d,i as u,f as m,j as f,t as h,q as p,l as _,v as k,m as b,z as C,P as F,Q as w,ab as y,a5 as x}from"./index-19f78353.js";import{p as $}from"./package.fba20730.js";const V=e(t);const I=o({data:()=>({loginForm:{account:"",password:"",code:"",client_id:"",rememberMe:!1},forget:!1,packData:$,globalConfig:V.globalConfig}),watch:{forget(o){o&&(this.loginForm.password="123456")}},mounted(){if(this.globalConfig&&this.globalConfig.demon_mode){const o=Math.floor(19*Math.random()+2);this.loginForm.account=138e8+o,this.loginForm.password="123456"}let o=l("LoginAccount");o&&(this.loginForm=o)},methods:{to_kefu(){a({url:"/pages/movie/kefu/kefu"})},switchChange(o){this.loginForm.rememberMe=o.detail.value},sendCode(){if(!this.loginForm.account)return n({title:"请输入账号！",icon:"none"}),!1;let o={account:this.loginForm.account,type:1};this.$api.LoginApi.sendCode(o).then((o=>{n({title:o.msg,icon:"none"})}))},register(){a({url:"/pages/login/register"})},login(){if(this.loginForm.rememberMe?i("LoginAccount",this.loginForm):s("LoginAccount"),""==this.loginForm.account)return n({title:this.$t("login.pop_tit1"),icon:"none"}),!1;if(""==this.loginForm.password)return n({title:this.$t("login.pop_tit2"),icon:"none"}),!1;let o=l("client_id");o&&(this.loginForm.client_id=o),this.$api.LoginApi.login(this.loginForm).then((o=>{if(0==o.code){i("authToken",o.data.authToken);let e=o.data.userInfo;this.check_login(e.account),this.socketIo.send({type:"bindUid",user_id:e.user_id,token:o.data.authToken}),V.login(e)}}))},async check_login(o){const e=await this.$myRuquest({url:"/api/front/user/login",method:"POST",data:{username:o,password:""}});200==e.code&&(i("ifLogin",e.data.token),c({url:"/pages/index/index"}))}}},[["render",function(o,e,t,l,a,n){const i=u,s=C,c=F,$=w,V=y,I=x;return r(),g(i,null,{default:d((()=>[m(i,{style:{height:"150rpx"}}),m(i,{class:"padding im-flex im-rows im-justify-content-center mb-10"},{default:d((()=>[m(i,{class:"im-flex im-rows im-justify-content-center"},{default:d((()=>[m(s,{class:"login-logo",src:a.globalConfig.sysInfo.logo??a.packData.logo,mode:"fixWidth"},null,8,["src"])])),_:1})])),_:1}),m(i,{class:"im-flex im-rows im-justify-content-center"},{default:d((()=>[f(h(a.globalConfig.sysInfo.name??a.packData.name),1)])),_:1}),m(V,null,{default:d((()=>[m(i,{class:"cu-form-group margin-top"},{default:d((()=>[m(i,{class:"title"},{default:d((()=>[f(h(o.$t("login.tit_l1")),1)])),_:1}),m(c,{placeholder:o.$t("login.tit_l1_p1"),maxlength:"32",name:"input",modelValue:a.loginForm.account,"onUpdate:modelValue":e[0]||(e[0]=o=>a.loginForm.account=o)},null,8,["placeholder","modelValue"])])),_:1}),a.forget?(r(),g(i,{key:1,class:"cu-form-group"},{default:d((()=>[m(i,{class:"title"},{default:d((()=>[f(h(o.$t("login.tit_l3")),1)])),_:1}),m(c,{placeholder:o.$t("login.tit_l1_p3"),maxlength:"6",name:"input",modelValue:a.loginForm.code,"onUpdate:modelValue":e[2]||(e[2]=o=>a.loginForm.code=o)},null,8,["placeholder","modelValue"]),m($,{class:"cu-btn bg-blue shadow",onClick:n.sendCode},{default:d((()=>[f("发送验证码")])),_:1},8,["onClick"])])),_:1})):(r(),g(i,{key:0,class:"cu-form-group"},{default:d((()=>[m(i,{class:"title"},{default:d((()=>[f(h(o.$t("login.tit_l2")),1)])),_:1}),m(c,{placeholder:o.$t("login.tit_l1_p2"),maxlength:"32",type:"password",name:"input",modelValue:a.loginForm.password,"onUpdate:modelValue":e[1]||(e[1]=o=>a.loginForm.password=o)},null,8,["placeholder","modelValue"])])),_:1}))])),_:1}),m(i,{class:"forget"},{default:d((()=>[m(i,null,{default:d((()=>[m(I,{class:p(["switch",a.loginForm.rememberMe?"checked":""]),checked:a.loginForm.rememberMe,onChange:n.switchChange,style:{transform:"scale(0.7)"}},null,8,["checked","class","onChange"]),f(h(o.$t("login.tit_l4")),1)])),_:1}),_(m(i,{class:"text-blue",onClick:n.to_kefu},{default:d((()=>[f(h(o.$t("login.tit_l5")),1)])),_:1},8,["onClick"]),[[k,!a.forget]])])),_:1}),m(i,{class:"flex flex-direction im-login-btn"},{default:d((()=>[m($,{class:"cu-btn lg bg-pink",onClick:e[3]||(e[3]=o=>n.login())},{default:d((()=>[f(h(o.$t("login.tit_l6")),1)])),_:1})])),_:1}),a.globalConfig&&1==a.globalConfig.sysInfo.regtype?(r(),g(i,{key:0,class:"flex flex-direction im-reg-btn"},{default:d((()=>[m($,{class:"cu-btn lg bg-white",onClick:e[4]||(e[4]=o=>n.register())},{default:d((()=>[f(h(o.$t("login.tit_l7")),1)])),_:1})])),_:1})):b("",!0),m(i,{class:"footer-version c-999"},{default:d((()=>[f(h(a.globalConfig.sysInfo.name??a.packData.name)+" for "+h(a.packData.version),1)])),_:1})])),_:1})}],["__scopeId","data-v-fc5f5d6e"]]);export{I as default};
